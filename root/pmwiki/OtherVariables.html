<!DOCTYPE html 
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>TagTrade Wiki | PmWiki / OtherVariables browse</title>
  <meta http-equiv="Content-type" content="text/html;charset=iso-8859-1" />
  <meta http-equiv='Content-Style-Type' content='text/css' />
  <link rel='stylesheet' href='/pmwiki/pub/skins/tagtrade/tagtrade.css' type='text/css' />
  <!--HeaderText--><style type='text/css'><!--
  ul, ol, pre, dl, p { margin-top:0px; margin-bottom:0px; }
  code.escaped { white-space: nowrap; }
  .vspace { margin-top:1.33em; }
  .indent { margin-left:40px; }
  .outdent { margin-left:40px; text-indent:-40px; }
  a.createlinktext { text-decoration:none; border-bottom:1px dotted gray; }
  a.createlink { text-decoration:none; position:relative; top:-0.5em;
    font-weight:bold; font-size:smaller; border-bottom:none; }
  img { border:0px; }
  .editconflict { color:green; 
  font-style:italic; margin-top:1.33em; margin-bottom:1.33em; }

  table.markup { border:2px dotted #ccf; width:90%; }
  td.markup1, td.markup2 { padding-left:10px; padding-right:10px; }
  table.vert td.markup1 { border-bottom:1px solid #ccf; }
  table.horiz td.markup1 { width:23em; border-right:1px solid #ccf; }
  table.markup caption { text-align:left; }
  div.faq p, div.faq pre { margin-left:2em; }
  div.faq p.question { margin:1em 0 0.75em 0; font-weight:bold; }
  div.faqtoc div.faq * { display:none; }
  div.faqtoc div.faq p.question 
    { display:block; font-weight:normal; margin:0.5em 0 0.5em 20px; line-height:normal; }
  div.faqtoc div.faq p.question * { display:inline; }
   
    .frame 
      { border:1px solid #cccccc; padding:4px; background-color:#f9f9f9; }
    .lfloat { float:left; margin-right:0.5em; }
    .rfloat { float:right; margin-left:0.5em; }
a.varlink { text-decoration:none; }

--></style>  <meta name='robots' content='noindex,nofollow' />

</head>
<body>
<!--PageHeaderFmt-->
  <div id='wikilogo'><a href=''><img src='/pmwiki/pub/skins/tagtrade/tagtrade-32.gif'
    alt='TagTrade Wiki' border='0' /></a></div>
  <div id='wikihead'>
  </div>
<!--/PageHeaderFmt-->
  <table id='wikimid' width='100%' cellspacing='0' cellpadding='0'><tr>
<!--PageLeftFmt-->
      <td id='wikileft' valign='top'>
        <p class='sidehead'> <a class='wikilink' href='/Main/HomePage'>Main</a>
</p><ul><li><a class='wikilink' href='/Main/Systems'>Systems</a>
</li><li><a class='wikilink' href='/Main/DiscussionGroups'>Discussion groups</a>
</li><li><a class='wikilink' href='/Main/Jabber'>Jabber group chat</a>
</li><li><a class='wikilink' href='/Main/Irc'>IRC channel</a>
</li><li><a class='wikilink' href='/Main/Events'>Events</a>
</li><li><a class='wikilink' href='/Main/TODO'>To do</a>
</li><li><a class='wikilink' href='/Main/WikiSandbox'>Wiki sandbox</a>
</li></ul><p class='vspace sidehead'> <a class='wikilink' href='/Devel/HomePage'>Devel</a>
</p><ul><li><a class='wikilink' href='/Devel/TODO'>To do</a>
</li><li><a class='wikilink' href='/Devel/BackEnd'>Back end</a>
</li><li><a class='wikilink' href='/Devel/FrontEnd'>Front end</a>
</li><li><a class='wikilink' href='/Devel/AuthoringPages'>Authoring pages</a>
</li></ul><p class='vspace sidehead'> <a class='wikilink' href='/Profiles/HomePage'>Profiles</a>
</p>
<p class='vspace sidehead'> <a class='wikilink' href='/PmWiki/PmWiki'>PmWiki</a>
</p>
<p class='vspace sidehead'> <a class='wikilink' href='/DocArchive/HomePage'>Doc archive</a>
</p>
<p class='vspace sidehead'> <a class='wikilink' href='/Portal/HomePage'>Portal</a>
</p><ul><li><a class='wikilink' href='/Portal/WikiSandbox'>Wiki sandbox</a>
</li></ul>
</td>
<!--/PageLeftFmt-->
      <td id='wikibody' valign='top'>
<!--PageTitleFmt-->
        <div id='wikititle'>
          <div class='pagegroup'><a href='/PmWiki'>PmWiki</a> /</div>
          <h1 class='pagetitle'>OtherVariables</h1></div>
<!--PageText-->
<div id='wikitext'>
<p>
<a name='trailstart' id='trailstart'></a> 
</p><div style="clear:right; float:right; font-size:smaller; background-color:#ddd;" >
<p><span class='wikitrail'>&lt; <a class='wikilink' href='/PmWiki/LinkVariables'>Link Variables</a> | <a class='wikilink' href='/PmWiki/Variables'>Variables</a> | <a class='wikilink' href='/PmWiki/PagelistVariables'>Pagelist Variables</a> &gt;</span> 
</p></div>
<div style="clear:right;" >
</div>
<p><a name='FmtV' id='FmtV'></a>
</p><dl><dt><a class='varlink' href='/PmWiki/OtherVariables#FmtV'><code class='varlink'>&#36;FmtV</code></a></dt><dd> 
</dd><dt> </dt><dd>This variable is an array that is used for string substitutions at the end of a call to <code><a class='wikilink' href='/PmWiki/FmtPageName'>FmtPageName</a>()</code>. For each element in the array, the "key" (interpreted as a string) will be replaced by the corresponding "value".  The variable is intended to be a place to store substitution variables that have frequently changing values (thus avoiding a rebuild of the variable cache making <code><a class='wikilink' href='/PmWiki/FmtPageName'>FmtPageName</a>()</code> faster). Also see <a class='varlink' href='/PmWiki/OtherVariables#FmtP'><code class='varlink'>&#36;FmtP</code></a>. <span  style='color: green;'><em>Values of <a class='varlink' href='/PmWiki/OtherVariables#FmtV'><code class='varlink'>&#36;FmtV</code></a> are set by the internal functions FormatTableRow, LinkIMap, HandleBrowse, PreviewPage, HandleEdit, PmWikiAuth, and PasswdVar, apparently to set values for system generated string substitutions like PageText.</em></span>
</dd></dl><p class='vspace'><a name='FmtP' id='FmtP'></a>
</p><dl><dt><a class='varlink' href='/PmWiki/OtherVariables#FmtP'><code class='varlink'>&#36;FmtP</code></a></dt><dd>
</dd><dt> </dt><dd>This variable is an array that is used for pattern substitutions near the beginning of a call to <code class='escaped'>FmtPageName</code>. For each element in the array, the "key" (interpreted as a pattern) will be replaced by the corresponding value evaluated for the name of the current page. This is for instance used to handle $-substitutions that depend on the pagename passed to <code class='escaped'>FmtPageName()</code>.  Also see <a class='varlink' href='/PmWiki/OtherVariables#FmtV'><code class='varlink'>&#36;FmtV</code></a>. <span  style='color: green;'>From robots.php: <em>If &#36;EnableRobotCloakActions is set, then a pattern is added to <a class='varlink' href='/PmWiki/OtherVariables#FmtP'><code class='varlink'>&#36;FmtP</code></a> to hide any "?action=" url parameters in page urls generated by PmWiki for actions that robots aren't allowed to access.  This can greatly reduce the load on the server by not providing the robot with links to pages that it will be forbidden to index anyway.</em></span>
</dd></dl><p class='vspace'><a name='FmtPV' id='FmtPV'></a>
</p><dl><dt><a class='varlink' href='/PmWiki/OtherVariables#FmtPV'><code class='varlink'>&#36;FmtPV</code></a></dt><dd>
</dd><dt> </dt><dd>This variable is an array that is used for defining <a class='wikilink' href='/PmWiki/PageVariables'>Page Variables</a>. New variables can be defined with <code class='escaped'>$FmtPV['$VarName'] = 'variable definition';</code> which can be used in markup with <code class='escaped'>{$VarName}</code>. Please note that the contents of <code class='escaped'>$FmtPV['$VarName']</code> are <code class='escaped'>eval()</code>ed to produce the final text for <code class='escaped'>$VarName</code>, so the contents must be a PHP expression which is valid at the time of substitution. In particular, <span  style='color: red;'>this does not work:</span>
<div class='vspace'></div><dl><dt> </dt><dd><span  style='color: red;'><code class='escaped'>#This doesn't work</code></span>
</dd><dt> </dt><dd><code class='escaped'>$FmtPV['$MyText'] = "This is my text."; # WARNING: Doesn't work!</code>
</dd></dl><div class='vspace'></div></dd><dt> </dt><dd>The problem is that the text <span  style='color: blue;'><code class='escaped'>This is my text.</code></span> is not a valid PHP expression. To work it would need to be placed in quotes, so that what actually gets stored in <code class='escaped'>$FmtPV['$MyText']</code> is <span  style='color: blue;'><code class='escaped'>"This is my text."</code></span> which <strong>is</strong> a valid PHP expression for a text string. Thus the correct way to do this would be with an extra set of quotes:
<div class='vspace'></div><dl><dt> </dt><dd><code class='escaped'>#This will work</code>
</dd><dt> </dt><dd><code class='escaped'>$FmtPV['$MyText'] = '"This is my text."';</code>
</dd></dl><div class='vspace'></div></dd><dt> </dt><dd>This also has implications for how internal PHP or PmWiki variables are accessed. To have the page variable <code class='escaped'>$MyVar</code> produce the contents of the internal variable <code class='escaped'>$myvar</code>, many folks try the following <span  style='color: red;'>which does not work:</span>
<div class='vspace'></div><dl><dt> </dt><dd><span  style='color: red;'><code class='escaped'>#This doesn't work either!</code></span>
</dd><dt> </dt><dd><code class='escaped'>$myvar = SomeComplexFunction();</code>
</dd><dt> </dt><dd><code class='escaped'>$FmtPV['$MyVar'] = $myvar; # WARNING: Doesn't work!</code>
</dd></dl><div class='vspace'></div></dd><dt> </dt><dd>There are several correct ways to do this, depending on whether you need the value of the <code class='escaped'>$myvar</code> variable as it was at the time the <code class='escaped'>$FmtPV</code> entry was created, or at the time that a particular instance of <code class='escaped'>$MyVar</code> is being rendered on a page. For most simple page variables that don't change during the processing of a page its more efficient to set the value when the entry is created:
<div class='vspace'></div><dl><dt> </dt><dd><code class='escaped'>$myvar = SomeComplexFunction();</code>
</dd><dt> </dt><dd><code class='escaped'>$FmtPV['$MyVar'] = "'" . $myvar . "'"; #capture contents of $myvar</code>
</dd></dl><div class='vspace'></div></dd><dt> </dt><dd>NOTE: If <code class='escaped'>$myvar</code> should contain single quotes, the above won't work as is, and you'll need to process the variable to escape any internal quotes.
<div class='vspace'></div></dd><dt> </dt><dd>For more complex cases where an internal variable may have different values at different places in the page (possibly due to the effects of other markup), then you need to make the <code class='escaped'>$FmtPV</code> entry make an explicit reference to the global value of the variable (and the variable had better be global) like this:
<div class='vspace'></div><dl><dt> </dt><dd><code class='escaped'>global $myvar;</code>
</dd><dt> </dt><dd><code class='escaped'>$FmtPV['$MyVar'] = '$GLOBALS["myvar"]';</code>
</dd></dl><div class='vspace'></div></dd><dt> </dt><dd>Finally, there's nothing to stop you from simply having the evaluation of the <code class='escaped'>$FmtPV</code> entry execute a function to determine the replacement text:
<div class='vspace'></div><dl><dt> </dt><dd><code class='escaped'># add page variable {$Today}, formats today's date as yyyy-mm-dd</code>
</dd><dt> </dt><dd><code class='escaped'>$FmtPV['$Today'] = 'strftime("%Y-%m-%d", time() )';</code>
</dd></dl><div class='vspace'></div></dd><dt> </dt><dd>See <a class='urllink' href='http://www.pmwiki.org/wiki/Cookbook/MoreCustomPageVariables' rel='nofollow'>Cookbook:MoreCustomPageVariables</a> for more examples of how to use <code class='escaped'>$FmtPV</code>.
<div class='vspace'></div></dd><dt><a name='MaxPageTextVars' id='MaxPageTextVars'></a><a class='varlink' href='/PmWiki/OtherVariables#MaxPageTextVars'><code class='varlink'>&#36;MaxPageTextVars</code></a></dt><dd> This variable prevents endless loops in accidental recursive <a class='wikilink' href='/PmWiki/PageTextVariables'>PageTextVariables</a> which could lock down a server. Default is 500 which means that each PageTextVariable from one page can be displayed up to 500 times in one wiki page.
</dd></dl><p> 
</p><div style="clear:right; float:right; font-size:smaller; background-color:#ddd;" >
<p><span class='wikitrail'>&lt; <a class='wikilink' href='/PmWiki/LinkVariables'>Link Variables</a> | <a class='wikilink' href='/PmWiki/Variables'>Variables</a> | <a class='wikilink' href='/PmWiki/PagelistVariables'>Pagelist Variables</a> &gt;</span> 
</p></div>
<p><a name='trailend' id='trailend'></a>
<br clear='all' />
</p><div  style='background-color: #ffe; border-top: 1px solid black; font-size: .8em;' > 
<p>This page may have <span class='commentout-pmwikiorg'> a more recent version on <a class='urllink' href='http://www.pmwiki.org' rel='nofollow'>pmwiki.org</a>: <a class='urllink' href='http://www.pmwiki.org/wiki/PmWiki/OtherVariables' rel='nofollow'>PmWiki:OtherVariables</a>, and </span> a talk page: <a class='urllink' href='http://www.pmwiki.org/wiki/PmWiki/OtherVariables-Talk' rel='nofollow'>PmWiki:OtherVariables-Talk</a>.
</p></div>
</div>

      </td>
    </tr></table>
<!--PageFooterFmt-->
  <div id='wikifoot'>
    <div class='footinfo'></div>
  </div>
<!--/PageFooterFmt-->
</body>
</html>
